

df_final = a.join(b, on=["common_column"], how="left_outer") \
    .withColumn("posting_amount_gc", F.coalesce(a["posting_amount_gc"], F.lit(0)) - F.coalesce(b["posting_amount_gc"], F.lit(0)))